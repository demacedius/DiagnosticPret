---
import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
const { userId } = Astro.locals.auth();
if (!userId) {
  return Astro.redirect('/connexion');
}

const user = await Astro.locals.currentUser();
const prenom = user?.firstName ?? 'utilisateur';
---

<BaseLayout
  title="Mon espace | DossierPrÃªt"
  description="Votre espace personnel DossierPrÃªt."
  noindex={true}
>
  <div class="min-h-screen flex flex-col">
    <Navbar currentPath="/dashboard" />

    <main class="flex-1 py-12 bg-gray-50 dark:bg-slate-900 transition-colors duration-200">
      <div class="container-main">

        <!-- Header -->
        <div class="mb-10">
          <p class="text-xs font-semibold text-gray-400 dark:text-slate-500 uppercase tracking-wider mb-1">Mon espace</p>
          <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Bonjour, {prenom} ðŸ‘‹</h1>
          <p class="text-gray-500 dark:text-slate-400 mt-1">GÃ©rez vos diagnostics et accÃ©dez Ã  votre plan d'action.</p>
        </div>

        <!-- Actions rapides -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-10">

          <!-- CTA Diagnostic complet -->
          <div class="card md:col-span-2 bg-gray-900 dark:bg-slate-800 border-gray-900 dark:border-slate-700">
            <div class="flex items-start gap-3 mb-5">
              <div class="w-9 h-9 bg-white/10 rounded-xl flex items-center justify-center flex-shrink-0">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round">
                  <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                </svg>
              </div>
              <div>
                <span class="text-xs font-semibold text-white/50 uppercase tracking-widest">Premium</span>
                <h2 class="text-lg font-bold text-white mt-0.5">Diagnostic complet</h2>
                <p class="text-sm text-white/60 mt-1">Analyse HCSF, plan d'action personnalisÃ©, simulations d'amortissement et export PDF.</p>
              </div>
            </div>
            <a
              href="/diagnostic"
              class="inline-flex items-center gap-2 px-4 py-2.5 bg-white text-gray-900 text-sm font-semibold rounded-lg hover:bg-gray-100 active:scale-[0.99] transition-all"
            >
              Lancer mon diagnostic
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
            </a>
          </div>

          <!-- Diagnostic express -->
          <div class="card">
            <p class="text-xs font-semibold text-gray-400 dark:text-slate-500 uppercase tracking-wider mb-3">Diagnostic express</p>
            <p class="text-sm text-gray-500 dark:text-slate-400 mb-3">VÃ©rification rapide en 4 champs sur la page d'accueil.</p>
            <a href="/" class="inline-flex items-center gap-1.5 text-xs font-medium text-gray-900 dark:text-slate-200 hover:opacity-70 transition-opacity">
              Lancer l'analyse express
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
            </a>
          </div>
        </div>

        <!-- Ce qui est inclus -->
        <div class="card">
          <h2 class="text-sm font-semibold text-gray-900 dark:text-white mb-4">Inclus dans votre diagnostic</h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
            {[
              { icon: 'ðŸ“Š', label: 'Score global du dossier', desc: 'Ã‰valuation sur 100 pts selon 5 critÃ¨res bancaires' },
              { icon: 'âš–ï¸', label: 'ConformitÃ© HCSF', desc: 'VÃ©rification du taux d\'endettement et de la durÃ©e max' },
              { icon: 'ðŸŽ¯', label: 'Plan d\'action prioritÃ©', desc: 'Points bloquants et leviers d\'amÃ©lioration classÃ©s' },
              { icon: 'ðŸ“ˆ', label: 'Simulations de taux', desc: '4 scÃ©narios de taux avec mensualitÃ© et coÃ»t total' },
              { icon: 'ðŸ“„', label: 'Export PDF', desc: 'Imprimez ou sauvegardez votre rapport complet' },
              { icon: 'ðŸ”’', label: 'DonnÃ©es confidentielles', desc: 'Aucune donnÃ©e transmise Ã  une banque ou un tiers' },
            ].map((f) => (
              <div class="flex items-start gap-3 p-3 rounded-xl bg-gray-50 dark:bg-slate-700/50">
                <span class="text-xl leading-none mt-0.5">{f.icon}</span>
                <div>
                  <p class="text-sm font-medium text-gray-900 dark:text-white">{f.label}</p>
                  <p class="text-xs text-gray-500 dark:text-slate-400 mt-0.5">{f.desc}</p>
                </div>
              </div>
            ))}
          </div>
        </div>

      </div>
    </main>

    <Footer />
  </div>
</BaseLayout>
