---
import BaseLayout from './BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title: string;
  description: string;
  date: Date;
  tags: string[];
  category: string;
  readingTime: number;
  slug: string;
}

const { title, description, date, tags, category, readingTime, slug } = Astro.props;

const dateStr = date.toLocaleDateString('fr-FR', { year: 'numeric', month: 'long', day: 'numeric' });
const siteUrl = 'https://dossierpret.fr';

const blogPostSchema = {
  '@context': 'https://schema.org',
  '@type': 'BlogPosting',
  headline: title,
  description,
  datePublished: date.toISOString(),
  author: { '@type': 'Organization', name: 'DossierPrêt' },
  publisher: { '@type': 'Organization', name: 'DossierPrêt', url: siteUrl },
  url: `${siteUrl}/blog/${slug}`,
};
---

<BaseLayout
  title={`${title} | DossierPrêt`}
  description={description}
  schema={blogPostSchema}
>
  <div class="min-h-screen flex flex-col">
    <Navbar currentPath="/blog" />

    <main class="flex-1">

      <!-- Hero header -->
      <div class="border-b border-gray-100 dark:border-slate-800 py-12 sm:py-16">
        <div class="max-w-3xl mx-auto px-5 sm:px-8">

          <!-- Breadcrumb -->
          <nav class="flex items-center gap-2 text-xs text-gray-400 dark:text-slate-500 mb-8">
            <a href="/" class="hover:text-gray-600 dark:hover:text-slate-300 transition-colors">Accueil</a>
            <span>/</span>
            <a href="/blog" class="hover:text-gray-600 dark:hover:text-slate-300 transition-colors">Blog</a>
            <span>/</span>
            <span class="text-gray-500 dark:text-slate-400 truncate max-w-[200px]">{title}</span>
          </nav>

          <!-- Category + tags -->
          <div class="flex flex-wrap items-center gap-2 mb-5">
            <span class="badge badge-amber">{category}</span>
            {tags.slice(0, 2).map(tag => (
              <span class="badge badge-gray">{tag}</span>
            ))}
          </div>

          <!-- Title -->
          <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white leading-tight mb-5">
            {title}
          </h1>

          <!-- Description -->
          <p class="text-lg sm:text-xl text-gray-500 dark:text-slate-400 leading-relaxed mb-7 max-w-2xl">
            {description}
          </p>

          <!-- Meta -->
          <div class="flex items-center gap-5 text-sm text-gray-400 dark:text-slate-500">
            <span class="flex items-center gap-2">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
              {dateStr}
            </span>
            <span class="w-1 h-1 rounded-full bg-gray-200 dark:bg-slate-700"></span>
            <span class="flex items-center gap-2">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
              {readingTime} min de lecture
            </span>
          </div>
        </div>
      </div>

      <!-- Article body -->
      <div class="py-12 sm:py-16">
        <div class="max-w-3xl mx-auto px-5 sm:px-8">
          <article class="prose prose-gray prose-lg max-w-none
            prose-headings:font-bold prose-headings:text-gray-900 prose-headings:leading-snug
            prose-h2:text-2xl prose-h2:mt-10 prose-h2:mb-4
            prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-3
            prose-p:text-gray-600 prose-p:leading-relaxed prose-p:text-base
            prose-a:text-gray-900 prose-a:font-medium prose-a:underline hover:prose-a:text-gray-600
            prose-strong:text-gray-900 prose-strong:font-semibold
            prose-ul:text-gray-600 prose-ol:text-gray-600
            prose-li:leading-relaxed prose-li:text-base
            prose-blockquote:border-l-4 prose-blockquote:border-gray-200 prose-blockquote:pl-5 prose-blockquote:text-gray-500 prose-blockquote:not-italic
            prose-hr:border-gray-100 prose-hr:my-10
            prose-code:text-gray-800 prose-code:bg-gray-100 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-normal
            dark:prose-invert
            dark:prose-headings:text-white
            dark:prose-p:text-slate-300
            dark:prose-a:text-slate-200 dark:hover:prose-a:text-white
            dark:prose-strong:text-white
            dark:prose-ul:text-slate-300 dark:prose-ol:text-slate-300
            dark:prose-li:text-slate-300
            dark:prose-blockquote:border-slate-700 dark:prose-blockquote:text-slate-400
            dark:prose-hr:border-slate-800
            dark:prose-code:text-slate-200 dark:prose-code:bg-slate-800">
            <slot />
          </article>

          <!-- End CTA -->
          <div class="mt-16 bg-gray-900 dark:bg-slate-800 rounded-2xl p-8 sm:p-10 text-white text-center">
            <p class="text-xs font-semibold text-white/40 uppercase tracking-widest mb-3">DossierPrêt</p>
            <h2 class="text-2xl sm:text-3xl font-bold mb-3">Analysez votre profil maintenant</h2>
            <p class="text-base text-white/60 mb-7 max-w-sm mx-auto leading-relaxed">
              Découvrez les risques de refus de votre dossier immobilier en 30 secondes, gratuitement.
            </p>
            <a
              href="/"
              class="inline-flex items-center gap-2 px-7 py-3.5 bg-white text-gray-900 font-semibold text-sm rounded-xl hover:bg-gray-100 transition-colors"
            >
              Lancer l'analyse gratuite
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
            </a>
          </div>

          <!-- Back to blog -->
          <div class="mt-10 pb-4">
            <a href="/blog" class="inline-flex items-center gap-2 text-sm text-gray-500 dark:text-slate-400 hover:text-gray-900 dark:hover:text-white transition-colors">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
              Retour au blog
            </a>
          </div>
        </div>
      </div>

    </main>

    <Footer />
  </div>
</BaseLayout>
